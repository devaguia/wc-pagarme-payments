(()=>{class e{constructor(){this.setClasses()}setClasses(){const e=document.querySelector("#mainform");e?.classList.add("wpp-container"),e?.classList.add("wpp-container-payment");const t=document.querySelectorAll("tr");t?.forEach((e=>{e.classList.add("top-wpp")}))}}class t{constructor(){this.reset()}create(){const e=document.querySelector("body"),t=document.createElement("i");t.setAttribute("id","wpp-popup-icon");const n=document.createElement("div");n.classList.add("wpp-popup-icon"),n.appendChild(t);const s=document.createElement("span");s.setAttribute("id","wpp-popup-title");const o=document.createElement("div");o.classList.add("wpp-popup-title"),o.appendChild(s);const a=document.createElement("span");a.setAttribute("id","wpp-popup-message");const c=document.createElement("div");c.classList.add("wpp-popup-message"),c.appendChild(a);const p=document.createElement("div");p.classList.add("wpp-popup"),p.appendChild(n),p.appendChild(o),p.appendChild(c);const i=document.createElement("div");i.classList.add("wpp-darker"),i.appendChild(p),e?.appendChild(i)}setIcon(e){const t=document.querySelector("#wpp-popup-icon");if(t)switch(e){case"error":t.className="fa-solid fa-circle-xmark";break;case"success":t.className="fa-solid fa-circle-check";break;case"loading":t.className="fa-solid fa-spinner";break;case"warning":t.className="fa-solid fa-triangle-exclamation";break;default:t.className=""}}setMessage(e){const t=document.querySelector("#wpp-popup-message");t&&(t.innerText=e)}setTitle(e){const t=document.querySelector("#wpp-popup-title");t&&(t.innerText=e)}setButton(e,t,n){const s=document.querySelector(".wpp-popup"),o=document.createElement("input");if(o){o.setAttribute("type","button"),o.setAttribute("id",n),o.classList=t,o.value=e;const a=document.createElement("div");a.classList.add("wpp-popup-button"),a.appendChild(o),s?.appendChild(a)}}setButtons(e){const t=document.querySelector(".wpp-popup"),n=document.createElement("div");n.classList.add("wpp-popup-button"),e.forEach((e=>{const t=document.createElement("input");console.log(t),t&&(t.setAttribute("type","button"),t.setAttribute("id",e.id),t.classList=e.classes,t.value=e.text,n.appendChild(t))})),t?.appendChild(n)}reset(){["#wpp-popup-icon","#wpp-popup-title","#wpp-popup-message",".wpp-popup",".wpp-darker"].forEach((e=>{const t=document.querySelector(e);t&&t.remove()}))}}class n{setWaitingPopup(){const e=new t;e.create(),e.setIcon("loading"),e.setTitle("Aguarde!"),e.setMessage("Carregando...")}setSuccessPopup(e,n){const s=new t;s.create(),s.setIcon("success"),s.setTitle(e),s.setMessage(n),s.setButtons([{text:"Confirmar",classes:"btn btn-success btn-reload",id:"wpp-success-form"}])}setErrorPopup(e,n){const s=new t;s.create(),s.setIcon("error"),s.setTitle(e),s.setMessage(n),s.setButtons([{text:"Cancelar",classes:"btn btn-failed btn-reload",id:"wpp-error-form"}])}setReloadFuncion(){document.querySelectorAll(".wpp-popup-button .btn-reload").forEach((e=>{e.addEventListener("click",(()=>{window.location.reload()}))}))}}class s extends n{constructor(e){super(),this.create(e)}create(e){const t=document.createElement("div");t.setAttribute("id","wpp-installments-container");const n=document.createElement("div");n.classList.add("wpp-installments"),n.innerHTML=e,t?.appendChild(n);const s=document.querySelector("body");s?.appendChild(t),this.submit(),this.setMask()}remove(){const e=document.querySelector("#wpp-installments-container");e?.remove()}submit(){const e=document.querySelector(".wpp-installments-settings > form");console.log(e),e?.addEventListener("submit",(t=>{t.preventDefault(),this.saveSettings(e)}))}saveSettings(e){const t=new FormData;t.append("action","save_pagarme_installments"),t.append("installments",JSON.stringify(this.get_installments())),this.setWaitingPopup(),fetch(`${window.location.origin}/wp-admin/admin-ajax.php`,{method:"POST",body:t}).then((e=>e.json())).then((e=>{if(e.content){const t=e.content,n=t?.message,s=t?.title;200===t?.code?this.setSuccessPopup(s,n):this.setErrorPopup(s,n),this.setReloadFuncion();const o=document.querySelector("#wpp-success-form");o&&o.addEventListener("click",(()=>{window.location.reload()}))}}))}get_installments(){const e=document.querySelectorAll(".wpp-installment"),t=[];return e?.forEach((e=>{const n=e.getAttribute("data-index");let s=parseFloat(e.value);s||(s=0);const o={index:n,value:s};t.push(o)})),t}setMask(){document.querySelectorAll(".wpp-installment").forEach((e=>{e.addEventListener("keyup",(()=>{const t=e.value.split("").at(-1);isNaN(t)&&"."!==t&&(e.value=","===t?e.value.replace(",","."):e.value.replace(t,""))}))}))}}class o{constructor(){document.querySelector("#woocommerce_wc-pagarme-credit_enabled")&&(new e,this.handleInstalments())}handleInstalments(){const e=document.querySelector("#woocommerce_wc-pagarme-credit_installments_config");e&&(e.value="Configure"),e?.addEventListener("click",(()=>{this.getInstallmentsSettings()}))}getInstallmentsSettings(){const e=new FormData;e.append("action","get_installment_settings"),fetch(`${window.location.origin}/wp-admin/admin-ajax.php`,{method:"POST",body:e}).then((e=>e.json())).then((function(e){if(e?.content){const t=new s(e.content),n=document.querySelector(".wpp-installments-settings > .close");n?.addEventListener("click",(()=>{t.remove()}))}}))}saveInstallmentsSettings(){const e=new FormData;e.append("action","save_installment_settings"),fetch(`${window.location.origin}/wp-admin/admin-ajax.php`,{method:"POST",body:e}).then((function(e){return e}))}}document.addEventListener("DOMContentLoaded",(()=>{new o}))})();
//# sourceMappingURL=index.js.map
